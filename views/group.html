<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-100">

<head>
  <meta charset="UTF-8">
  <title>水群助手</title>

  <link href="assets/css/daisyui-4.4.14-full.min.css" rel="stylesheet" type="text/css"/>
  <link href="assets/css/index.css" rel="stylesheet" type="text/css"/>

  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/axios/1.5.0/axios.min.js"></script>

  <script src="assets/js/index.js"></script>
</head>

<body class="h-full">
<div class="min-h-full">
  {{ template "head.html" "group" }}

  <main class="-mt-32">
    <div class="mx-auto max-w-7xl px-4 pb-12 sm:px-6 lg:px-8">
      <div class="rounded-lg bg-white px-5 py-6 shadow sm:px-6 text-2xl">
        <table class="min-w-full divide-y divide-gray-300">
          <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">群名称
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              最后活跃时间
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              是否在通讯录
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              是否启用AI
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              是否启用水群排行榜
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              是否启用聊天记录总结
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              是否启用迎新
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              是否启用指令
            </th>
            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
              操作
            </th>
          </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 bg-white">
          {{ range .groups }}
          <tr class="even:bg-gray-50">
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              <div class="font-medium text-gray-900">{{ .Nickname }}</div>
              <div class="mt-1 truncate text-gray-500">{{ .Wxid }}</div>
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ if eq .LastActive.IsNil true }}
              无数据
              {{ else }}
              {{ .LastActive }}
              {{ end }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ template "flagTag" .IsOk }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ template "ai" . }}
              <!-- 使用的模型 -->
              {{ if eq .EnableAi true }}
              <select id="location" name="location"
                      class="mt-2 block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-green-600 sm:text-sm sm:leading-6"
                      onchange="aiModelChange(event, {{.Wxid}})">
                <option value="" {{ if eq .AiModel
                "" }}selected{{ end }}>默认(gpt-3.5-turbo-0613)
                </option>

                {{$useModel := .AiModel}}
                {{ range $.aiModels }}
                <option value="{{.Model}}" {{ if eq $useModel .Model}}selected{{ end }}>
                  {{.Name}}({{.Model}})
                </option>
                {{ end }}
              </select>
              {{ end }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ template "chatRank" . }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ template "summary" . }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ template "welcome" . }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              {{ template "command" . }}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
              <button class="btn btn-link" onclick="getGroupUsers({{.Wxid}}, {{.Nickname}})">成员</button>
            </td>
          </tr>
          {{ end }}
          </tbody>
        </table>
      </div>
    </div>
  </main>

  {{ template "footer.html" }}

  {{ template "groupuser.html" }}
</div>

</body>
